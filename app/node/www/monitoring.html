<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Alonso Rodriguez">
    <meta name="description" content="Dashboard del cluster Clupiter">
    <meta name="robots" content="noindex">
    <title>Clupiter App</title>
</head>
<body>
    <header>
        <div id="logo"><img src="/logo.png" alt="clupiter logo" srcset="/logo.svg">Clupiter Dashboard</div>
        <nav>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/monitoring.html">Monitoring</a></li>
                <li><a href="/about.html">About</a></li>
            </ul>
        </nav>
    </header>

    <div id=main_monitor>

        <div id="cpu_monitor">        
            <!-- RPI0 -->
            <div id=rpi0_div class="rpi_block">
                <div class=rpi_div__zonecpu>
                    <div data-netdata="system.cpu"
                    data-dimensions="user"
                    data-chart-library="gauge"
                    data-width="20em"
                    data-after="-60"
                    data-points="60"
                    data-max="100"
                    data-title="RPI0 CPU Utilisation"
                    data-units="%"
                    data-colors="#FF5555"
                    data-gauge-max-value="100"
                    ></div>
                    <div data-netdata="system.cpu"
                    data-dimensions="user"
                    data-chart-library="dygraph"
                    data-dygraph-theme="sparkline"
                    data-width="20em"
                    data-height="3em"
                    data-after="-60"
                    data-points="60"
                    data-dygraph-valuerange="[0, 100]"
                    data-colors="#FF5555 #FF5555 #FF5555 #FF5555 #FF5555 #FF5555"
                    ></div>
                </div>
                
                <div class=rpi_div__zonenet>
                    <div class=rpi_div__zonenet__pies>
                        <div data-netdata="system.net"
                        data-dimensions="received"
                        data-decimal-digits="0"
                        data-title="Ingoing Traffic"
                        data-chart-library="easypiechart"
                        data-width="10em"
                        data-height="100%"
                        data-after="-60"
                        data-points="60"
                        data-colors="#66A919"
                        ></div>
                        <div data-netdata="system.net"
                        data-dimensions="sent"
                        data-decimal-digits="0"
                        data-title="Outgoing Traffic"
                        data-chart-library="easypiechart"
                        data-width="10em"
                        data-height="100%"
                        data-after="-60"
                        data-points="60"
                        data-colors="#FD3100"
                        ></div>
                    </div>
                    <div data-netdata="system.net"
                    data-chart-library="dygraph"
                    data-dygraph-theme="sparkline"
                    data-width="20em"
                    data-height="3em"
                    data-after="-60"
                    data-points="60"
                    data-colors="#66A919 #FD3100"
                    ></div>
                </div>
            </div>
            
            <!-- RPI1 -->
            <div id=rpi1_div class="rpi_block">
                <div class=rpi_div__zonecpu>
                    <div data-netdata="system.cpu"
                    data-dimensions="user"
                    data-host="http://192.168.0.221:19999"
                    data-chart-library="gauge"
                    data-width="20em"
                    data-after="-60"
                    data-points="60"
                    data-max="100"
                    data-title="RPI1 CPU Utilisation"
                    data-units="%"
                    data-colors="#FF5555"
                    data-gauge-max-value="100"
                    ></div>
                    <div data-netdata="system.cpu"
                    data-host="http://192.168.0.221:19999"
                    data-dimensions="user"
                    data-chart-library="dygraph"
                    data-dygraph-theme="sparkline"
                    data-width="20em"
                    data-height="3em"
                    data-after="-60"
                    data-points="60"
                    data-dygraph-valuerange="[0, 100]"
                    data-colors="#FF5555 #FF5555 #FF5555 #FF5555 #FF5555 #FF5555"
                    ></div>
                </div>
                
                <div class=rpi_div__zonenet>
                    <div class=rpi_div__zonenet__pies>
                        <div data-netdata="system.net"
                        data-host="http://192.168.0.221:19999"
                        data-dimensions="received"
                        data-decimal-digits="0"
                        data-title="Ingoing Traffic"
                        data-chart-library="easypiechart"
                        data-width="10em"
                        data-height="100%"
                        data-after="-60"
                        data-points="60"
                        data-colors="#66A919"
                        ></div>
                        <div data-netdata="system.net"
                        data-host="http://192.168.0.221:19999"
                        data-dimensions="sent"
                        data-decimal-digits="0"
                        data-title="Outgoing Traffic"
                        data-chart-library="easypiechart"
                        data-width="10em"
                        data-height="100%"
                        data-after="-60"
                        data-points="60"
                        data-colors="#FD3100"
                        ></div>
                    </div>
                    <div data-netdata="system.net"
                    data-host="http://192.168.0.221:19999"
                    data-chart-library="dygraph"
                    data-dygraph-theme="sparkline"
                    data-width="20em"
                    data-height="3em"
                    data-after="-60"
                    data-points="60"
                    data-colors="#66A919 #FD3100"
                    ></div>
                </div>
            </div>
            
            <!-- RPI2 -->
            <div id=rpi2_div class="rpi_block">
                <div class=rpi_div__zonecpu>
                    <div data-netdata="system.cpu"
                    data-dimensions="user"
                    data-host="http://192.168.0.222:19999"
                    data-chart-library="gauge"
                    data-width="20em"
                    data-after="-60"
                    data-points="60"
                    data-max="100"
                    data-title="RPI2 CPU Utilisation"
                    data-units="%"
                    data-colors="#FF5555"
                    data-gauge-max-value="100"
                    ></div>
                    <div data-netdata="system.cpu"
                    data-host="http://192.168.0.222:19999"
                    data-dimensions="user"
                    data-chart-library="dygraph"
                    data-dygraph-theme="sparkline"
                    data-width="20em"
                    data-height="3em"
                    data-after="-60"
                    data-points="60"
                    data-dygraph-valuerange="[0, 100]"
                    data-colors="#FF5555 #FF5555 #FF5555 #FF5555 #FF5555 #FF5555"
                    ></div>
                </div>
                
                <div class=rpi_div__zonenet>
                    <div class=rpi_div__zonenet__pies>
                        <div data-netdata="system.net"
                        data-host="http://192.168.0.222:19999"
                        data-dimensions="received"
                        data-decimal-digits="0"
                        data-title="Ingoing Traffic"
                        data-chart-library="easypiechart"
                        data-width="10em"
                        data-height="100%"
                        data-after="-60"
                        data-points="60"
                        data-colors="#66A919"
                        ></div>
                        <div data-netdata="system.net"
                        data-host="http://192.168.0.222:19999"
                        data-dimensions="sent"
                        data-decimal-digits="0"
                        data-title="Outgoing Traffic"
                        data-chart-library="easypiechart"
                        data-width="10em"
                        data-height="100%"
                        data-after="-60"
                        data-points="60"
                        data-colors="#FD3100"
                        ></div>
                    </div>
                    <div data-netdata="system.net"
                    data-host="http://192.168.0.222:19999"
                    data-chart-library="dygraph"
                    data-dygraph-theme="sparkline"
                    data-width="20em"
                    data-height="3em"
                    data-after="-60"
                    data-points="60"
                    data-colors="#66A919 #FD3100"
                    ></div>
                </div>
            </div>

            <!-- RPI3 -->
            <div id=rpi3_div class="rpi_block">
                <div class=rpi_div__zonecpu>
                    <div data-netdata="system.cpu"
                    data-dimensions="user"
                    data-host="http://192.168.0.223:19999"
                    data-chart-library="gauge"
                    data-width="20em"
                    data-after="-60"
                    data-points="60"
                    data-max="100"
                    data-title="RPI3 CPU Utilisation"
                    data-units="%"
                    data-colors="#FF5555"
                    data-gauge-max-value="100"
                    ></div>
                    <div data-netdata="system.cpu"
                    data-host="http://192.168.0.223:19999"
                    data-dimensions="user"
                    data-chart-library="dygraph"
                    data-dygraph-theme="sparkline"
                    data-width="20em"
                    data-height="3em"
                    data-after="-60"
                    data-points="60"
                    data-dygraph-valuerange="[0, 100]"
                    data-colors="#FF5555 #FF5555 #FF5555 #FF5555 #FF5555 #FF5555"
                    ></div>
                </div>
                
                <div class=rpi_div__zonenet>
                    <div class=rpi_div__zonenet__pies>
                        <div data-netdata="system.net"
                        data-host="http://192.168.0.223:19999"
                        data-dimensions="received"
                        data-decimal-digits="0"
                        data-title="Ingoing Traffic"
                        data-chart-library="easypiechart"
                        data-width="10em"
                        data-height="100%"
                        data-after="-60"
                        data-points="60"
                        data-colors="#66A919"
                        ></div>
                        <div data-netdata="system.net"
                        data-host="http://192.168.0.223:19999"
                        data-dimensions="sent"
                        data-decimal-digits="0"
                        data-title="Outgoing Traffic"
                        data-chart-library="easypiechart"
                        data-width="10em"
                        data-height="100%"
                        data-after="-60"
                        data-points="60"
                        data-colors="#FD3100"
                        ></div>
                    </div>
                    <div data-netdata="system.net"
                    data-host="http://192.168.0.223:19999"
                    data-chart-library="dygraph"
                    data-dygraph-theme="sparkline"
                    data-width="20em"
                    data-height="3em"
                    data-after="-60"
                    data-points="60"
                    data-colors="#66A919 #FD3100"
                    ></div>
                </div>
            </div>
            
            <!-- RPI4 -->
            <div id=rpi4_div class="rpi_block">
                <div class=rpi_div__zonecpu>
                    <div data-netdata="system.cpu"
                    data-dimensions="user"
                    data-host="http://192.168.0.224:19999"
                    data-chart-library="gauge"
                    data-width="20em"
                    data-after="-60"
                    data-points="60"
                    data-max="100"
                    data-title="RPI4 CPU Utilisation"
                    data-units="%"
                    data-colors="#FF5555"
                    data-gauge-max-value="100"
                    ></div>
                    <div data-netdata="system.cpu"
                    data-host="http://192.168.0.224:19999"
                    data-dimensions="user"
                    data-chart-library="dygraph"
                    data-dygraph-theme="sparkline"
                    data-width="20em"
                    data-height="3em"
                    data-after="-60"
                    data-points="60"
                    data-dygraph-valuerange="[0, 100]"
                    data-colors="#FF5555 #FF5555 #FF5555 #FF5555 #FF5555 #FF5555"
                    ></div>
                </div>
                
                <div class=rpi_div__zonenet>
                    <div class=rpi_div__zonenet__pies>
                        <div data-netdata="system.net"
                        data-host="http://192.168.0.224:19999"
                        data-dimensions="received"
                        data-decimal-digits="0"
                        data-title="Ingoing Traffic"
                        data-chart-library="easypiechart"
                        data-width="10em"
                        data-height="100%"
                        data-after="-60"
                        data-points="60"
                        data-colors="#66A919"
                        ></div>
                        <div data-netdata="system.net"
                        data-host="http://192.168.0.224:19999"
                        data-dimensions="sent"
                        data-decimal-digits="0"
                        data-title="Outgoing Traffic"
                        data-chart-library="easypiechart"
                        data-width="10em"
                        data-height="100%"
                        data-after="-60"
                        data-points="60"
                        data-colors="#FD3100"
                        ></div>
                    </div>
                    <div data-netdata="system.net"
                    data-host="http://192.168.0.224:19999"
                    data-chart-library="dygraph"
                    data-dygraph-theme="sparkline"
                    data-width="20em"
                    data-height="3em"
                    data-after="-60"
                    data-points="60"
                    data-colors="#66A919 #FD3100"
                    ></div>
                </div>
            </div>

            <!-- RPI5 -->
            <div id=rpi5_div class="rpi_block">
                <div class=rpi_div__zonecpu>
                    <div data-netdata="system.cpu"
                    data-dimensions="user"
                    data-host="http://192.168.0.225:19999"
                    data-chart-library="gauge"
                    data-width="20em"
                    data-after="-60"
                    data-points="60"
                    data-max="100"
                    data-title="RPI5 CPU Utilisation"
                    data-units="%"
                    data-colors="#FF5555"
                    data-gauge-max-value="100"
                    ></div>
                    <div data-netdata="system.cpu"
                    data-host="http://192.168.0.225:19999"
                    data-dimensions="user"
                    data-chart-library="dygraph"
                    data-dygraph-theme="sparkline"
                    data-width="20em"
                    data-height="3em"
                    data-after="-60"
                    data-points="60"
                    data-dygraph-valuerange="[0, 100]"
                    data-colors="#FF5555 #FF5555 #FF5555 #FF5555 #FF5555 #FF5555"
                    ></div>
                </div>
                
                <div class=rpi_div__zonenet>
                    <div class=rpi_div__zonenet__pies>
                        <div data-netdata="system.net"
                        data-host="http://192.168.0.225:19999"
                        data-dimensions="received"
                        data-decimal-digits="0"
                        data-title="Ingoing Traffic"
                        data-chart-library="easypiechart"
                        data-width="10em"
                        data-height="100%"
                        data-after="-60"
                        data-points="60"
                        data-colors="#66A919"
                        ></div>
                        <div data-netdata="system.net"
                        data-host="http://192.168.0.225:19999"
                        data-dimensions="sent"
                        data-decimal-digits="0"
                        data-title="Outgoing Traffic"
                        data-chart-library="easypiechart"
                        data-width="10em"
                        data-height="100%"
                        data-after="-60"
                        data-points="60"
                        data-colors="#FD3100"
                        ></div>
                    </div>
                    <div data-netdata="system.net"
                    data-host="http://192.168.0.225:19999"
                    data-chart-library="dygraph"
                    data-dygraph-theme="sparkline"
                    data-width="20em"
                    data-height="3em"
                    data-after="-60"
                    data-points="60"
                    data-colors="#66A919 #FD3100"
                    ></div>
                </div>
            </div>

            <!-- RPI6 -->
            <div id=rpi6_div class="rpi_block">
                <div class=rpi_div__zonecpu>
                    <div data-netdata="system.cpu"
                    data-dimensions="user"
                    data-host="http://192.168.0.226:19999"
                    data-chart-library="gauge"
                    data-width="20em"
                    data-after="-60"
                    data-points="60"
                    data-max="100"
                    data-title="RPI6 CPU Utilisation"
                    data-units="%"
                    data-colors="#FF5555"
                    data-gauge-max-value="100"
                    ></div>
                    <div data-netdata="system.cpu"
                    data-host="http://192.168.0.226:19999"
                    data-dimensions="user"
                    data-chart-library="dygraph"
                    data-dygraph-theme="sparkline"
                    data-width="20em"
                    data-height="3em"
                    data-after="-60"
                    data-points="60"
                    data-dygraph-valuerange="[0, 100]"
                    data-colors="#FF5555 #FF5555 #FF5555 #FF5555 #FF5555 #FF5555"
                    ></div>
                </div>
                
                <div class=rpi_div__zonenet>
                    <div class=rpi_div__zonenet__pies>
                        <div data-netdata="system.net"
                        data-host="http://192.168.0.226:19999"
                        data-dimensions="received"
                        data-decimal-digits="0"
                        data-title="Ingoing Traffic"
                        data-chart-library="easypiechart"
                        data-width="10em"
                        data-height="100%"
                        data-after="-60"
                        data-points="60"
                        data-colors="#66A919"
                        ></div>
                        <div data-netdata="system.net"
                        data-host="http://192.168.0.226:19999"
                        data-dimensions="sent"
                        data-decimal-digits="0"
                        data-title="Outgoing Traffic"
                        data-chart-library="easypiechart"
                        data-width="10em"
                        data-height="100%"
                        data-after="-60"
                        data-points="60"
                        data-colors="#FD3100"
                        ></div>
                    </div>
                    <div data-netdata="system.net"
                    data-host="http://192.168.0.226:19999"
                    data-chart-library="dygraph"
                    data-dygraph-theme="sparkline"
                    data-width="20em"
                    data-height="3em"
                    data-after="-60"
                    data-points="60"
                    data-colors="#66A919 #FD3100"
                    ></div>
                </div>
            </div>

            <!-- RPI7 -->
            <div id=rpi7_div class="rpi_block">
                <div class=rpi_div__zonecpu>
                    <div data-netdata="system.cpu"
                    data-dimensions="user"
                    data-host="http://192.168.0.227:19999"
                    data-chart-library="gauge"
                    data-width="20em"
                    data-after="-60"
                    data-points="60"
                    data-max="100"
                    data-title="RPI7 CPU Utilisation"
                    data-units="%"
                    data-colors="#FF5555"
                    data-gauge-max-value="100"
                    ></div>
                    <div data-netdata="system.cpu"
                    data-host="http://192.168.0.227:19999"
                    data-dimensions="user"
                    data-chart-library="dygraph"
                    data-dygraph-theme="sparkline"
                    data-width="20em"
                    data-height="3em"
                    data-after="-60"
                    data-points="60"
                    data-dygraph-valuerange="[0, 100]"
                    data-colors="#FF5555 #FF5555 #FF5555 #FF5555 #FF5555 #FF5555"
                    ></div>
                </div>
                
                <div class=rpi_div__zonenet>
                    <div class=rpi_div__zonenet__pies>
                        <div data-netdata="system.net"
                        data-host="http://192.168.0.227:19999"
                        data-dimensions="received"
                        data-decimal-digits="0"
                        data-title="Ingoing Traffic"
                        data-chart-library="easypiechart"
                        data-width="10em"
                        data-height="100%"
                        data-after="-60"
                        data-points="60"
                        data-colors="#66A919"
                        ></div>
                        <div data-netdata="system.net"
                        data-host="http://192.168.0.227:19999"
                        data-dimensions="sent"
                        data-decimal-digits="0"
                        data-title="Outgoing Traffic"
                        data-chart-library="easypiechart"
                        data-width="10em"
                        data-height="100%"
                        data-after="-60"
                        data-points="60"
                        data-colors="#FD3100"
                        ></div>
                    </div>
                    <div data-netdata="system.net"
                    data-host="http://192.168.0.227:19999"
                    data-chart-library="dygraph"
                    data-dygraph-theme="sparkline"
                    data-width="20em"
                    data-height="3em"
                    data-after="-60"
                    data-points="60"
                    data-colors="#66A919 #FD3100"
                    ></div>
                </div>
            </div>
        </div>
        
        <div id="buttons">
            <button id="buttons__form__lu" class="buttons__form-button" type="submit" onclick="spawn('lu')">LU</button>
            <button id="buttons__form__cg" class="buttons__form-button" type="submit" onclick="spawn('cg')">CG</button>
            <button id="buttons__form__ft" class="buttons__form-button" type="submit" onclick="spawn('ft')">FT</button>
            <button id="buttons__form__is" class="buttons__form-button" type="submit" onclick="spawn('is')">IS</button>
            <button id="buttons__form__mg" class="buttons__form-button" type="submit" onclick="spawn('mg')">MG</button>
            <button id="buttons__form__ep" class="buttons__form-button" type="submit" onclick="spawn('ep')">EP</button>
        </div>

        <div id="terminal_container">
            <textarea id="terminal_monitor" rows="4" cols="100%" readonly></textarea>
            <button id="button_clear_terminal" class="buttons__form-button" onclick="clearTextArea()">Clear Terminal</button>
            <button id="button_poweroff" class="buttons__form-button" onclick="warnPoweroff()">Poweroff</button>
        </div>
        
    </div>
        
        
        <!-- Netdata dashboards -->
    <script type="text/javascript" src="http://192.168.0.220:19999/dashboard.js"></script>
        
    <script>
        // destroy charts not shown (lowers memory on the browser)
        // NETDATA.options.current.destroy_on_hide = true;
        
        // set this to false, to always show all dimensions
        NETDATA.options.current.eliminate_zero_dimensions = true;
        
        // lower the pressure on this browser
        NETDATA.options.current.concurrent_refreshes = false;
        
        // if the tv browser is too slow (a pi?)
        // set this to false
        NETDATA.options.current.parallel_refresher = true;
        
        // always update the charts, even if focus is lost
        NETDATA.options.current.stop_updates_when_focus_is_lost = false;
    </script>

    <!-- JS Script start -->
    <script src="/socket.io/socket.io.js"></script>
    <script>
        var socket = io();

        var textarea = document.getElementById('terminal_monitor');

        function toggleButtonActivation(disabled){
            var buttons = document.getElementsByClassName('buttons__form-button');

            for (var i = 0; i < buttons.length; i++) {
                buttons[i].disabled = disabled;
            }
        }

        function spawn(bench_name) {
            toggleButtonActivation(true);
            socket.emit('spawn', bench_name);
        }

        function addTextToTextArea(text) {
            textarea.innerHTML += text;
            textarea.scrollTop = textarea.scrollHeight;
        }

        function addBlankLineToTextArea() {
            addTextToTextArea('\n');
        }

        function clearTextArea() {
            textarea.innerHTML = '';
            addTextToTextArea('');            
        }

        function warnPoweroff() {
            if(confirm('Are you sure you want to poweroff?')){
                var button = document.getElementById('button_poweroff');

                // Preparar para segundo click
                button.style.background = '#fc2600';
                button.textContent = 'Click again to poweroff'
                button.setAttribute( "onClick", "javascript: secondStagePoweroff();" );

                setTimeout(() => {
                    // si no se hace click en 5 segundos se restablece
                    button.setAttribute( "onClick", "javascript: warnPoweroff();" );
                    button.style.background = '#FF4081';
                    button.textContent = 'Poweroff';
                }, 5000);
            }
        }

        function secondStagePoweroff() {
            toggleButtonActivation(true);
            clearTextArea();

            // Ponemos la textarea a rojo y las letras en grande
            textarea.style.backgroundColor = '#ffd4cc';
            textarea.style.borderColor = '#fc2600';
            textarea.style.fontSize += 4;

            spawn('poweroff');
        }

        socket.on('youve_got_mail', (msg) => addTextToTextArea(msg));

        socket.on('finished_execution', function(msg) {
            toggleButtonActivation(false);
            addBlankLineToTextArea();
            addBlankLineToTextArea();
            addTextToTextArea(msg);
            addBlankLineToTextArea();
            addBlankLineToTextArea();
        });
    </script>
</body>

<!-- Tengo que cargar esto aquí para evitar conflicto con el css que carga netdata -->
<link rel="stylesheet" href="style.css">

</html>